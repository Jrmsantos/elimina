<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roleta de Elimina√ß√£o - Base de Dados Roleta</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            width: 100%;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .description {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .config-section {
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
        }
        
        .config-form {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: end;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            font-weight: bold;
            color: #fdbb2d;
        }
        
        input {
            padding: 10px;
            border-radius: 5px;
            border: none;
            background-color: rgba(255, 255, 255, 0.9);
            width: 300px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            width: 100%;
            justify-content: center;
        }
        
        .roulette-section {
            flex: 1;
            min-width: 400px;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .lists-section {
            flex: 1;
            min-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .list-container {
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            padding: 20px;
            flex: 1;
        }
        
        h2 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.8rem;
            color: #fdbb2d;
        }
        
        .roulette-container {
            width: 100%;
            height: 400px;
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            background-color: rgba(0, 0, 0, 0.8);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
            border: 3px solid #fdbb2d;
        }
        
        .roulette-wheel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            transition: transform 8s cubic-bezier(0.1, 0.2, 0.1, 1);
        }
        
        .roulette-item {
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            position: relative;
        }
        
        .roulette-item.selected {
            background-color: rgba(178, 31, 31, 0.8);
            color: white;
            box-shadow: 0 0 15px rgba(178, 31, 31, 0.8);
            transform: scale(1.05);
        }
        
        .roulette-item.highlight {
            animation: highlight 1s ease-in-out;
        }
        
        @keyframes highlight {
            0% { background-color: rgba(253, 187, 45, 0.3); }
            50% { background-color: rgba(253, 187, 45, 0.7); }
            100% { background-color: rgba(253, 187, 45, 0.3); }
        }
        
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        #connectButton, #spinButton {
            background-color: #fdbb2d;
            color: #1a2a6c;
        }
        
        #connectButton:hover, #spinButton:hover {
            background-color: #ffcc44;
            transform: translateY(-3px);
        }
        
        #resetButton {
            background-color: #1a2a6c;
            color: white;
        }
        
        #resetButton:hover {
            background-color: #2a3a9c;
            transform: translateY(-3px);
        }
        
        .names-list {
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
        }
        
        .name-item {
            padding: 8px 12px;
            margin-bottom: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .eliminated {
            background-color: rgba(178, 31, 31, 0.3);
            text-decoration: line-through;
        }
        
        .counter {
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 15px;
            color: #fdbb2d;
        }
        
        .spinning {
            animation: pulse 0.5s infinite alternate;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }
        
        .status.connected {
            background-color: rgba(76, 175, 80, 0.3);
            color: #a5d6a7;
        }
        
        .status.disconnected {
            background-color: rgba(244, 67, 54, 0.3);
            color: #ef9a9a;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        .eliminated-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #b21f1f, #1a2a6c);
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
            box-shadow: 0 0 30px rgba(253, 187, 45, 0.5);
            border: 3px solid #fdbb2d;
        }
        
        .modal-title {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #fdbb2d;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .eliminated-list {
            text-align: left;
            margin: 20px 0;
        }
        
        .eliminated-item {
            padding: 10px;
            margin: 8px 0;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            border-left: 4px solid #fdbb2d;
            display: flex;
            justify-content: space-between;
        }
        
        .eliminated-number {
            font-weight: bold;
            color: #fdbb2d;
            margin-right: 10px;
        }
        
        .close-modal {
            background-color: #fdbb2d;
            color: #1a2a6c;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fdbb2d, #b21f1f);
            width: 0%;
            transition: width 0.3s;
        }
        
        .selection-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background: rgba(253, 187, 45, 0.3);
            border: 2px solid #fdbb2d;
            border-radius: 5px;
            z-index: 10;
            transition: top 0.5s;
            box-shadow: 0 0 15px #fdbb2d;
            display: none;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        @keyframes celebration {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .celebration {
            animation: celebration 0.5s ease-in-out 3;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .roulette-section, .lists-section {
                width: 100%;
            }
            
            input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Roleta de Elimina√ß√£o - Base de Dados Roleta</h1>
            <p class="description">Sistema conectado √† sua planilha do Google Sheets. A roleta elimina 10 nomes por vez com efeito especial!</p>
        </header>
        
        <section class="config-section">
            <h2>Conex√£o com a Planilha</h2>
            <div class="config-form">
                <div class="form-group">
                    <label for="apiKey">Chave da API Google Sheets:</label>
                    <input type="text" id="apiKey" value="AIzaSyB17vvXebj9ObGzjHWqrJmg59F0yW30f5Q" placeholder="Sua chave da API Google Sheets">
                </div>
                <button id="connectButton">Conectar √† Planilha</button>
            </div>
            <div id="connectionStatus" class="status disconnected">Desconectado - Use a chave da API para conectar</div>
        </section>
        
        <div class="main-content">
            <section class="roulette-section">
                <h2>Roleta da Elimina√ß√£o</h2>
                <div class="roulette-container">
                    <div class="selection-animation" id="selectionAnimation"></div>
                    <div class="roulette-wheel" id="rouletteWheel">
                        <div class="roulette-item">Conecte √† planilha para come√ßar</div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="controls">
                    <button id="spinButton" disabled>Girar Roleta</button>
                    <button id="resetButton">Recarregar Dados</button>
                </div>
                <div class="counter">
                    Nomes restantes: <span id="remainingCount">0</span> | Eliminados: <span id="eliminatedCount">0</span>
                </div>
            </section>
            
            <section class="lists-section">
                <div class="list-container">
                    <h2>Nomes Restantes</h2>
                    <div class="names-list" id="remainingNames">
                        <div class="name-item">Conecte √† planilha para carregar os nomes</div>
                    </div>
                </div>
                
                <div class="list-container">
                    <h2>Eliminados</h2>
                    <div class="names-list" id="eliminatedNames">
                        <div class="name-item">Nenhum nome eliminado ainda</div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="eliminated-modal" id="eliminatedModal">
        <div class="modal-content">
            <h2 class="modal-title">üéØ NOMES ELIMINADOS üéØ</h2>
            <div class="eliminated-list" id="modalEliminatedList">
                </div>
            <div class="counter">
                Total de Eliminados: <span id="modalEliminatedCount">0</span>
            </div>
            <button class="close-modal" id="closeModal">Fechar</button>
        </div>
    </div>

    <script>
        // ID da sua planilha (extra√≠do do URL)
        const SHEET_ID = '1fLGjY6AzOlVbJoT3lyDQV33nnJVCRQxAMVWIuL2EJ2g';
        // URL do seu Google Apps Script para a opera√ß√£o de ESCRITA/ATUALIZA√á√ÉO
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyPQ2qO0izoByoTWsLFlDivdjG7u3oewXdXc97mCThMe3rJB5Wxdma8CM--StxbQ8LF/exec'; // ‚¨ÖÔ∏è SUA URL INSERIDA AQUI
        
        // Vari√°veis globais
        let remainingNames = [];
        let eliminatedNames = [];
        let apiKey = '';
        let isConnected = false;
        let isSpinning = false;
        
        // Elementos DOM
        const rouletteWheel = document.getElementById('rouletteWheel');
        const remainingNamesList = document.getElementById('remainingNames');
        const eliminatedNamesList = document.getElementById('eliminatedNames');
        const spinButton = document.getElementById('spinButton');
        const resetButton = document.getElementById('resetButton');
        const connectButton = document.getElementById('connectButton');
        const apiKeyInput = document.getElementById('apiKey');
        const connectionStatus = document.getElementById('connectionStatus');
        const remainingCount = document.getElementById('remainingCount');
        const eliminatedCount = document.getElementById('eliminatedCount');
        const progressBar = document.getElementById('progressBar');
        const selectionAnimation = document.getElementById('selectionAnimation');
        const eliminatedModal = document.getElementById('eliminatedModal');
        const modalEliminatedList = document.getElementById('modalEliminatedList');
        const modalEliminatedCount = document.getElementById('modalEliminatedCount');
        const closeModal = document.getElementById('closeModal');
        
        // Conectar √† planilha (Fun√ß√£o de LEITURA - usa API Key)
        async function connectToSheet() {
            apiKey = apiKeyInput.value.trim();
            
            if (!apiKey) {
                alert('Por favor, insira sua chave da API Google Sheets.');
                return;
            }
            
            try {
                connectButton.disabled = true;
                connectButton.innerHTML = '<span class="loading"></span> Conectando...';
                connectionStatus.textContent = 'Conectando √† planilha...';
                
                // Carregar nomes restantes - usando range correto
                const remainingUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/NomesRestantes!A2:A?key=${apiKey}`;
                const remainingResponse = await fetch(remainingUrl);
                const remainingData = await remainingResponse.json();
                
                if (remainingData.error) {
                    throw new Error(remainingData.error.message);
                }
                
                // Carregar nomes eliminados - usando range correto (Agora B, para incluir a data)
                const eliminatedUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Eliminados!A2:A?key=${apiKey}`;
                const eliminatedResponse = await fetch(eliminatedUrl);
                const eliminatedData = await eliminatedResponse.json();
                
                // Processar dados
                remainingNames = remainingData.values ? remainingData.values.flat().filter(name => name && name.trim() !== '') : [];
                eliminatedNames = eliminatedData.values ? eliminatedData.values.flat().filter(name => name && name.trim() !== '') : [];
                
                console.log('Nomes carregados:', {
                    restantes: remainingNames.length,
                    eliminados: eliminatedNames.length
                });
                
                // Atualizar UI
                updateUI();
                
                // Atualizar status
                isConnected = true;
                connectionStatus.textContent = `Conectado! ${remainingNames.length} nomes restantes e ${eliminatedNames.length} eliminados.`;
                connectionStatus.className = 'status connected';
                spinButton.disabled = false;
                
            } catch (error) {
                console.error('Erro ao conectar:', error);
                connectionStatus.textContent = `Erro: ${error.message}`;
                connectionStatus.className = 'status disconnected';
                
                if (error.message.includes('API key not valid')) {
                    alert('Chave da API inv√°lida. Por favor, verifique sua chave da API Google Sheets.');
                } else if (error.message.includes('Unable to parse range')) {
                    alert('Erro ao acessar a planilha. Verifique se as abas "NomesRestantes" e "Eliminados" existem.');
                } else {
                    alert(`Erro ao conectar √† planilha: ${error.message}`);
                }
            } finally {
                connectButton.disabled = false;
                connectButton.textContent = 'Conectar √† Planilha';
            }
        }
        
        // Atualizar a interface do usu√°rio
        function updateUI() {
            // Atualizar contadores
            remainingCount.textContent = remainingNames.length.toLocaleString('pt-BR');
            eliminatedCount.textContent = eliminatedNames.length.toLocaleString('pt-BR');
            
            // Atualizar lista de nomes restantes
            remainingNamesList.innerHTML = '';
            if (remainingNames.length === 0) {
                const emptyElement = document.createElement('div');
                emptyElement.className = 'name-item';
                emptyElement.textContent = 'Nenhum nome restante';
                remainingNamesList.appendChild(emptyElement);
                spinButton.disabled = true;
            } else {
                remainingNames.slice(0, 50).forEach(name => {
                    const nameElement = document.createElement('div');
                    nameElement.className = 'name-item';
                    nameElement.textContent = name;
                    remainingNamesList.appendChild(nameElement);
                });
                
                if (remainingNames.length > 50) {
                    const moreElement = document.createElement('div');
                    moreElement.className = 'name-item';
                    moreElement.textContent = `... e mais ${(remainingNames.length - 50).toLocaleString('pt-BR')} nomes`;
                    moreElement.style.fontStyle = 'italic';
                    remainingNamesList.appendChild(moreElement);
                }
                spinButton.disabled = false; // Habilita o bot√£o se houver nomes
            }
            
            // Atualizar lista de eliminados
            eliminatedNamesList.innerHTML = '';
            if (eliminatedNames.length === 0) {
                const emptyElement = document.createElement('div');
                emptyElement.className = 'name-item eliminated';
                emptyElement.textContent = 'Nenhum nome eliminado ainda';
                eliminatedNamesList.appendChild(emptyElement);
            } else {
                eliminatedNames.slice(-50).forEach(name => {
                    const nameElement = document.createElement('div');
                    nameElement.className = 'name-item eliminated';
                    nameElement.textContent = name;
                    eliminatedNamesList.appendChild(nameElement);
                });
                
                if (eliminatedNames.length > 50) {
                    const moreElement = document.createElement('div');
                    moreElement.className = 'name-item eliminated';
                    moreElement.textContent = `... e mais ${(eliminatedNames.length - 50).toLocaleString('pt-BR')} nomes`;
                    moreElement.style.fontStyle = 'italic';
                    eliminatedNamesList.appendChild(moreElement);
                }
            }
            
            // Atualizar roleta com os primeiros nomes
            updateRoulette();
        }
        
        // Atualizar a roleta com os primeiros nomes
        function updateRoulette() {
            rouletteWheel.innerHTML = '';
            
            if (remainingNames.length === 0) {
                const emptyElement = document.createElement('div');
                emptyElement.className = 'roulette-item';
                emptyElement.textContent = 'Nenhum nome restante';
                rouletteWheel.appendChild(emptyElement);
                return;
            }
            
            // Cria uma lista para a roleta com repeti√ß√µes para o efeito de giro
            const namesForWheel = [];
            const namesToShow = remainingNames.slice(0, 30);
            
            // Repete a lista para garantir um giro longo (ajuste o 3 para menos ou mais voltas)
            for (let i = 0; i < 3; i++) {
                namesForWheel.push(...namesToShow);
            }
            
            namesForWheel.forEach(name => {
                const nameElement = document.createElement('div');
                nameElement.className = 'roulette-item';
                nameElement.textContent = name;
                rouletteWheel.appendChild(nameElement);
            });
        }
        
        // Girar a roleta e selecionar 10 nomes
        async function spinRoulette() {
            const ELIMINATION_COUNT = 10;
            
            if (remainingNames.length < ELIMINATION_COUNT) {
                alert(`N√£o h√° nomes suficientes para eliminar! S√£o necess√°rios pelo menos ${ELIMINATION_COUNT} nomes.`);
                return;
            }
            
            if (isSpinning) return;
            isSpinning = true;
            
            // Desabilitar o bot√£o durante a anima√ß√£o
            spinButton.disabled = true;
            spinButton.classList.add('spinning');
            spinButton.textContent = 'Sorteando...';
            
            // Selecionar 10 nomes aleat√≥rios
            const selectedNames = [];
            const tempRemaining = [...remainingNames];
            
            for (let i = 0; i < ELIMINATION_COUNT; i++) {
                if (tempRemaining.length === 0) break;
                
                const randomIndex = Math.floor(Math.random() * tempRemaining.length);
                selectedNames.push(tempRemaining[randomIndex]);
                tempRemaining.splice(randomIndex, 1);
            }
            
            // Iniciar anima√ß√£o de progresso
            progressBar.style.width = '0%';
            const totalDuration = 9000; // 9 segundos
            
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += (100 / (totalDuration / 100)); // Calcula o incremento para 9s
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                }
            }, 100);
            
            // Animar a roleta com efeito mais longo
            const itemHeight = 50;
            // C√°lculo: Mova para uma posi√ß√£o longe o suficiente, por exemplo, 20 itens antes do final.
            const totalItems = rouletteWheel.children.length;
            const targetPosition = -((totalItems - 20) * itemHeight);
            
            rouletteWheel.style.transition = 'transform 8s cubic-bezier(0.1, 0.2, 0.1, 1)';
            rouletteWheel.style.transform = `translateY(${targetPosition}px)`;
            
            // Efeito de sele√ß√£o individual
            setTimeout(() => {
                animateIndividualSelection(selectedNames);
            }, 3000);
            
            // Ap√≥s a anima√ß√£o, processar a elimina√ß√£o
            setTimeout(async () => {
                try {
                    // üéØ CHAVE: Enviar os nomes eliminados para o Apps Script
                    await updateSheet(selectedNames);
                    
                    // Recarregar os dados da planilha para sincronizar o front-end
                    await connectToSheet();
                    
                    // Mostrar modal com os eliminados
                    showEliminatedModal(selectedNames);
                    
                } catch (error) {
                    console.error('Erro ao atualizar planilha:', error);
                    alert('Erro ao atualizar a planilha. Os dados podem n√£o ter sido salvos. Verifique a URL do Apps Script e as permiss√µes.');
                } finally {
                    // Reativar o bot√£o
                    spinButton.disabled = false;
                    spinButton.classList.remove('spinning');
                    spinButton.textContent = 'Girar Roleta';
                    // Resetar a posi√ß√£o da roleta para come√ßar de onde a lista parou (Visual apenas)
                    rouletteWheel.style.transition = 'none';
                    rouletteWheel.style.transform = 'translateY(0)';
                    
                    isSpinning = false;
                    selectionAnimation.style.display = 'none';
                }
            }, totalDuration);
        }
        
        // Animar a sele√ß√£o individual dos nomes
        function animateIndividualSelection(selectedNames) {
            const items = rouletteWheel.querySelectorAll('.roulette-item');
            let currentIndex = 0;
            
            selectionAnimation.style.display = 'block';
            
            const selectionInterval = setInterval(() => {
                if (currentIndex >= selectedNames.length) {
                    clearInterval(selectionInterval);
                    return;
                }
                
                const currentName = selectedNames[currentIndex];
                let itemIndex = -1;
                
                // Encontra a primeira ocorr√™ncia do nome na roleta
                for (let i = 0; i < items.length; i++) {
                    if (items[i].textContent === currentName) {
                        itemIndex = i;
                        break;
                    }
                }
                
                if (itemIndex !== -1) {
                    // Calcula a posi√ß√£o de topo do item
                    const currentWheelOffset = rouletteWheel.style.transform.match(/translateY\(([^)]+)\)/);
                    const offsetValue = currentWheelOffset ? parseFloat(currentWheelOffset[1]) : 0;
                    const animationTop = itemIndex * 50 + offsetValue;
                    
                    selectionAnimation.style.top = `${animationTop}px`;
                    
                    items[itemIndex].classList.add('highlight');
                    setTimeout(() => {
                        items[itemIndex].classList.remove('highlight');
                    }, 500);
                }
                
                currentIndex++;
            }, 500);
        }
        
        // Mostrar modal com nomes eliminados
        function showEliminatedModal(names) {
            modalEliminatedList.innerHTML = '';
            modalEliminatedCount.textContent = eliminatedNames.length.toLocaleString('pt-BR');
            
            names.forEach((name, index) => {
                const item = document.createElement('div');
                item.className = 'eliminated-item';
                item.innerHTML = `
                    <div>
                        <span class="eliminated-number">${index + 1}.</span>
                        <span>${name}</span>
                    </div>
                    <div>ELIMINADO</div>
                `;
                modalEliminatedList.appendChild(item);
            });
            
            eliminatedModal.style.display = 'flex';
            document.body.classList.add('celebration');
        }
        
        // üéØ NOVA FUN√á√ÉO DE ESCRITA - Usa o Google Apps Script (POST) 
        async function updateSheet(namesToEliminate) {
            try {
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ names: namesToEliminate })
                });

                const result = await response.json();

                if (result.status === 'error') {
                    throw new Error(result.message);
                }

                console.log('Planilha atualizada via Apps Script com sucesso!');
                return true;

            } catch (error) {
                console.error('Erro ao atualizar planilha via Apps Script:', error);
                // Propaga o erro para ser capturado no spinRoulette
                throw error; 
            }
        }
        
        // Recarregar dados da planilha
        function reloadData() {
            if (isConnected) {
                connectToSheet();
            } else {
                alert('Conecte-se √† planilha primeiro.');
            }
        }
        
        // Fechar modal
        function closeEliminatedModal() {
            eliminatedModal.style.display = 'none';
            document.body.classList.remove('celebration');
        }
        
        // Event listeners
        connectButton.addEventListener('click', connectToSheet);
        spinButton.addEventListener('click', spinRoulette);
        resetButton.addEventListener('click', reloadData);
        closeModal.addEventListener('click', closeEliminatedModal);
        
        // Fechar modal ao clicar fora
        eliminatedModal.addEventListener('click', function(e) {
            if (e.target === eliminatedModal) {
                closeEliminatedModal();
            }
        });
        
        // Permitir conectar pressionando Enter no campo da API Key
        apiKeyInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                connectToSheet();
            }
        });
        
        // Conectar automaticamente se j√° tiver a chave da API
        window.addEventListener('load', function() {
            if (apiKeyInput.value) {
                setTimeout(connectToSheet, 1000);
            }
        });
        
        console.log('Roleta de Elimina√ß√£o - Pronto para usar!');
    </script>
</body>
</html>
